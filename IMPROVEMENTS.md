# 改善提案（B1）

| # | 改善案 | 効果 | コスト | 優先度 |
|---|--------|------|--------|--------|
| 1 | **CSV出力のBOM除去** — 現在 `utf-8-sig` (BOM付き) で出力。Pythonスクリプトから読むとき `utf-8-sig` 指定が必要 | 他ツールとの互換性向上 | 低（io部分を `utf-8` に変更） | 中 |
| 2 | **インデックス最適化** — `PBPA_APP_DATE`, `TGPP_NUMBER` にもインデックス追加 | 大規模クエリの高速化（特に B, C） | 低（schema に2行追加） | 中 |
| 3 | **増分ロード** — 既存SQLiteに対してCSVの差分行だけINSERT | 490万行の再ロード時間を削減 | 中（rownum比較ロジック追加） | 高 |
| 4 | **テンプレートの年次サマリ** — A〜E に年次集計済みビューを追加 | ユーザが period=year を指定しなくても概要が見える | 低（SQLテンプレ追加） | 低 |
| 5 | **Excel のシート名短縮** — 31文字制限に対応 | 一部企業名が長い場合のExcelエラー防止 | 低（truncate+hash） | 中 |
| 6 | **並列ジョブ実行** — A〜E を multiprocessing で並列化 | 実行時間を30-50%短縮 | 中（SQLite WALモード + 接続プール） | 高 |
| 7 | **Web UI ダッシュボード** — Flask/Streamlit で Excel の代替 | 対話的な探索が可能に | 高（新規開発） | 低 |
| 8 | **CI/CD パイプライン** — GitHub Actions でdebug_flow.pyを自動実行 | 回帰テストの自動化 | 中（Actions YAML + テストデータ） | 中 |
